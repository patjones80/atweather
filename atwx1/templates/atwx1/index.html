<!DOCTYPE html>

<html lang="en" data-bs-theme="light">
	<head>

        <!-- Google Tag Manager -->

        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-W4N9WM52');</script>

        <!-- End Google Tag Manager -->
        <!-- Google tag (gtag.js) -->

        <script async src="https://www.googletagmanager.com/gtag/js?id=G-K56C7S78PM"></script>
        <script>
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'G-K56C7S78PM');
        </script>

		<script>

		(() => {
		  'use strict'

		  const getStoredTheme = () => localStorage.getItem('theme')
		  const setStoredTheme = theme => localStorage.setItem('theme', theme)

		  const getPreferredTheme = () => {
			const storedTheme = getStoredTheme()
			if (storedTheme) {
			  return storedTheme
			}

			return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'
		  }

		  const setTheme = theme => {
			if (theme === 'light') {
			  document.documentElement.setAttribute('data-bs-theme', (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'))
			} else {
			  document.documentElement.setAttribute('data-bs-theme', theme)
			}
		  }

		  setTheme(getPreferredTheme())

		  const showActiveTheme = (theme, focus = false) => {
			const themeSwitcher = document.querySelector('#toggle-mode')

			if (!themeSwitcher) {
			  return
			}

			if (focus) {
			  themeSwitcher.focus()
			}
		  }

		  window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', () => {
			const storedTheme = getStoredTheme()
			if (storedTheme !== 'light' && storedTheme !== 'dark') {
			  setTheme(getPreferredTheme())
			}
		  })

		  window.addEventListener('DOMContentLoaded', () => {
			showActiveTheme(getPreferredTheme())

				const toggle = document.querySelector('#toggle-mode')
				const boxes = [ "#update_box"
							  , "#forecast_box"
							  , "#about_box"
							  , "#error_box"
							  , "#resources_box"
							  , "#interpret_box"
							  , "#wind_chill_box"
							  , "#learn_nwp_box"
							  , "#lapse_rate_box"
							  , "#no_forecast_box"
							  , "#site_changes"
							  , "#disclaimer_box"
							  , "#no_forecast_error_box"
							  ];

				toggle.addEventListener('click', () => {
				  const theme = toggle.checked ? 'dark' : 'light';

				  setStoredTheme(theme)
				  setTheme(theme)
				  showActiveTheme(theme, true)

					for (var i=0; i < boxes.length; i++) {
						if (boxes[i]) {
							console.log(boxes[i]);
							if (document.querySelector(boxes[i])) {
								const aBox = document.querySelector(boxes[i]);
								if (toggle.checked) {
									aBox.setAttribute('class', 'card text-bg-secondary p-3');
								}
								else {
									aBox.setAttribute('class', 'card text-bg-light p-3');
								}
							}
						}
					}
				})
		  })
		})()

		</script>

		{% load static %}
		<link rel="stylesheet" type="text/css" href="{% static 'style.css' %}" >

		<title>Appalachian and Pacific Crest Trail Weather</title>

		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
		<link href="https://fonts.googleapis.com/css?family=Karla|Roboto+Condensed|Sacramento" rel="stylesheet">

		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>

		<!-- Bootstrap Font Icon CSS -->
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">		

		<link rel="shortcut icon" href="{% static 'favicon.ico' %}" type="image/x-icon">
		<link rel="icon" href="{% static 'favicon.ico' %}" type="image/x-icon">

	</head>

	<body>
		<div class="container">
			<div style="padding-top:20px;">
				<h3>Appalachian and Pacific Crest Trail Weather</h3>
				<p>The purpose of this website is simple: to provide AT and PCT hikers with a reliable and easy way to obtain weather for their location. Simply pick your trail, state and location from the lists below and the National Weather Service (NOAA) forecast for that location will appear.</p>
			</div>

			<ul class="nav nav-pills">
			  <li class="nav-item">
				<a class="nav-link {{ active_home }}" aria-current="page" href="/">Home</a>
			  </li>
			  <li class="nav-item">
				<a class="nav-link {{ active_about }}" href="/about">About</a>
			  </li>
			  <li class="nav-item">
				<a class="nav-link {{ active_other }}" href="/other">Resources</a>
			  </li>
			  <li class="nav-item">
				<a class="nav-link" href="https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&business=patjones80%40gmail%2ecom&lc=US&item_name=Appalachian%20Trail%20Weather&item_number=atwx&amount=0%2e00&currency_code=USD&button_subtype=services&tax_rate=0%2e000&shipping=0%2e00&bn=PP%2dBuyNowBF%3abtn_buynow_SM%2egif%3aNonHosted">Donate</a>
			  </li>
			  <li class="nav-item">
				<a class="nav-link {{ active_learn }}" href="/learn">Learn</a>
			  </li>
			</ul>

			<div style="padding-top: 20px;" class="row">
				<div style="padding-top:5px;" class="col-sm-3">
					<select class="form-control" id="trail_state" name="trail_state">
						<option selected="selected" value="">Select state...</option>
						{% for s in states %}
							<option value="{{ s.0 }}" {{ s.2 }}>{{ s.1 }}</option>
						{% endfor %}
					</select>
				</div>

				<div style="padding-top:5px;" class="col-sm-3">
					<form action="/forecast" method="GET">
						<select class="form-control" id="location_id" name="location_id" onchange="this.form.submit()">
							<option selected="selected" value="" class="labelText">Select location...</option>

							{% for k, v in locations.items %}
								<option value={{ k }} class="{{ v.state }}">{{ v.name }}</option>
							{% endfor %}

						</select>
					</form>
				</div>
			</div>

			<div style="padding-top:20px; padding-bottom:20px;">
				<form class="d-flex" role="search">
					<li class="nav-item align-items-center d-flex" >
					<i class="bi bi-sun-fill"></i>
					<div class="ms-2 form-check form-switch">
						<input class="form-check-input me-2" type="checkbox" role="switch" id="toggle-mode" />
					</div>
					<i class="bi bi-moon-fill" style="font-size: smaller;"></i>
					</li>
				</form>
			</div>

			<div id="update_box" class="card text-bg-light p-3" style="text-align:left;">
				<div class="card-body">
					<h5 class="card-title">Updates <span class="badge text-bg-info">New</span></h5>
					<p class="card-text">Read about changes to AT Weather's URLs <a href="/url_changes">here</a>, see the AT Conservancy's page on everything <a href="https://appalachiantrail.org/helene-recovery-resources-updates/">Hurricane Helene related</a>, and check out the <b>Resources</b> tab above for a list of other trail weather resources.</p>
				</div>
			</div>

            		{% block forecast %} 	{% endblock %}
			{% block about %} 	{% endblock %}
			{% block other %} 	{% endblock %}
			{% block learn_menu %}	{% endblock %}
			{% block url_changes %}	{% endblock %}
			{% block disclaimer %}	{% endblock %}
			{% block http_error %}	{% endblock %}
			{% block no_forecast %}	{% endblock %}

			<select hidden id="locationHidden" name="locationHidden">
				<option selected="selected" value="" class="labelText">Select location...</option>

				{% for k, v in locations_full.items %}
					<option value={{ k }} class="{{ v.state }}">{{ v.name }}</option>
				{% endfor %}
			</select>

			<div id="footer" style="padding-top:20px;">
				<p>Powered by Django {{ django_version }} | Â© Pat Jones 2014-2025 | <a href="/disclaimer">Disclaimer</a></p>
			</div>

		</div>

	    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

		<script>
			const currentTheme = localStorage.theme;
			console.log(currentTheme);

			const boxes = [ "update_box"
			              , "forecast_box"
						  , "about_box"
						  , "error_box"
						  , "resources_box"
						  , "interpret_box"
						  , "wind_chill_box"
						  , "learn_nwp_box"
						  , "lapse_rate_box"
						  , "no_forecast_box"
						  , "site_changes"
						  , "disclaimer_box"
						  , "no_forecast_error_box"
						  ];

				if (currentTheme === 'dark') {
					const all_cards = document.getElementsByClassName('card text-bg-light p-3');
					console.log('here 1');

					for (var i=0; i < boxes.length; i++) {
						if (boxes[i]) {
							if (document.getElementById(boxes[i])) {
								document.getElementById(boxes[i]).setAttribute('class', 'card text-bg-secondary p-3');
							}
						}
					}
				} else {
					const all_cards = document.getElementsByClassName('card text-bg-secondary p-3');

					for (var i=0; i < boxes.length; i++) {
						if (boxes[i]) {
							if (document.getElementById(boxes[i])) {
								console.log('here');
								document.getElementById(boxes[i]).setAttribute('class', 'card text-bg-light p-3');
							}
						}
					}
				}
		</script>

		<script>

			const toggle = document.getElementById('toggle-mode');
			toggle.checked = localStorage.theme === "dark";

			$(document).ready(function()
			{
				$('.pagination .disabled a, .pagination .active a').on('click', function(e) {
					e.preventDefault();
				});

				var allLocationsGlobal=$('#locationHidden option');

				$(trail_state).change(function()
				{
					<!-- a selection was made from the state list -->
					var currState=document.getElementById("trail_state").value;
					var currStateLocations=allLocationsGlobal.filter('.labelText,.' + currState);

					<!-- remove everything from the shelter list and repopulate only with the filtered list -->
					$('#location_id option').remove();
					$.each(currStateLocations, function (i, j)
					{
						$(j).appendTo('#location_id');
					});
					document.getElementById('location_id').selectedIndex="0";
				});
			});
		</script>
	</body>
</html>